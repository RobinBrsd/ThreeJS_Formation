<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title> ThreeJS Formation </title>
    <link rel="stylesheet" href="./style.css">
</head>
<body>
    <button id="light" onclick="toogleLight()"> Light On ! </button>
    <h1 id="loader"> Loading ... </h1>
    <script src="three.min.js"></script>
    <script src="OrbitControls.js"></script>
    <script>
        var scene, camera, renderer, mouse, raycaster;

        this.click = false;
        this.light;
        this.plight;
        this.plight2;
        this.plight3;
        this.plight4;
                
        function init(){
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x000000);

            camera = new THREE.PerspectiveCamera(70, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.x = -500;

            renderer = new THREE.WebGLRenderer();
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.body.appendChild(renderer.domElement);

            var manager = new THREE.LoadingManager();
            manager.onLoad = function ( ) {
                setTimeout(() => {
                    let loading = document.getElementById("loader");
                loading.style.display = "none";
                }, 1000);
            };
            manager.onLoad();

            window.addEventListener('resize', () => {
                renderer.setSize(window.innerWidth,window.innerHeight);
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
            })

            
            let controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableZoom = false;
            controls.maxDistance = 300;
            controls.maxPolarAngle = Math.PI/2; 
            controls.keys = {
                LEFT: 37, //left arrow
                UP: 38, // up arrow
                RIGHT: 39, // right arrow
                BOTTOM: 40 // down arrow
            }
            controls.keyPanSpeed = 40;
            controls.update();

            this.light = new THREE.AmbientLight(0x404040, 0.5);
            scene.add(this.light);

            raycaster = new THREE.Raycaster();
            mouse = new THREE.Vector2();
            window.addEventListener('mousedown', onMouseMove);

            let geo = new THREE.PlaneBufferGeometry(20000, 20000, 0, 0);
            let mat = new THREE.MeshMatcapMaterial({ color: 0x0d0d0d, side: THREE.DoubleSide });
            let plane = new THREE.Mesh(geo, mat);
            plane.name = "plane";
            scene.add(plane);
            plane.rotateX( - Math.PI / 2);
            plane.position.y = -151;

            generateText();
            animate();
        }
    
        function generateText(){
            var textMaterial = [
                new THREE.MeshPhongMaterial({ color: 0x0384fc }),
                new THREE.MeshPhongMaterial({ color: 0xf5b942 }),
                new THREE.MeshPhongMaterial({ color: 0xb338d1 }),
                new THREE.MeshPhongMaterial({ color: 0xe04159 }),
                new THREE.MeshPhongMaterial({ color: 0x2a4663 }),
                new THREE.MeshPhongMaterial({ color: 0x0051a8 }),
                new THREE.MeshPhongMaterial({ color: 0x85857f }),
                new THREE.MeshPhongMaterial({ color: 0xe37d59 }),
                new THREE.MeshPhongMaterial({ color: 0x41e083 }),
            ]
            
            // project 1
            var loader = new THREE.FontLoader();
            let text = `PROJECT : 
Basics One`;

            loader.load( './Blueberry Regular_Regular.json', function (font) {
                var textGeom = new THREE.TextGeometry(text, {
                    font: font,
                    size: 50,
                    height: 5,
                    bevelEnabled: true,
                });

                var textMesh = new THREE.Mesh(textGeom, textMaterial[0]);
                textMesh.rotation.y = -0.8;
                textMesh.position.z = -500;
                textMesh.position.x = 200;
                textMesh.name = "basics_one";
                scene.add(textMesh);
            });

                        
            // project 2
            var loader = new THREE.FontLoader();
            let text2 = `PROJECT :
Basics Two`;
            loader.load( './Blueberry Regular_Regular.json', function (font) {
                var textGeom = new THREE.TextGeometry(text2, {
                    font: font,
                    size: 50,
                    height: 5,
                    bevelEnabled: true,
                });

                var textMesh = new THREE.Mesh(textGeom, textMaterial[1]);
                textMesh.rotation.y = 4;
                textMesh.position.z = 100;
                textMesh.position.x = 500;
                textMesh.name = "basics_two";
                scene.add(textMesh);
            });

            // project 3
            var loader = new THREE.FontLoader();
            let text3 = `PROJECT :
    Portal`;
            loader.load( './Blueberry Regular_Regular.json', function (font) {
                var textGeom = new THREE.TextGeometry(text3, {
                    font: font,
                    size: 50,
                    height: 5,
                    bevelEnabled: true,
                });

                var textMesh = new THREE.Mesh(textGeom, textMaterial[2]);
                textMesh.rotation.y = -1.5;
                textMesh.position.z = -260;
                textMesh.position.x = 450;
                textMesh.position.y = 250;
                textMesh.name = "portal";
                scene.add(textMesh);
            });

            // project 4
            var loader = new THREE.FontLoader();
            let text4 = `PROJECT :
     Car`;
            loader.load( './Blueberry Regular_Regular.json', function (font) {
                var textGeom = new THREE.TextGeometry(text4, {
                    font: font,
                    size: 50,
                    height: 5,
                    bevelEnabled: true,
                });

                var textMesh = new THREE.Mesh(textGeom, textMaterial[3]);
                textMesh.rotation.y = -2.9;
                textMesh.position.z = 380;
                textMesh.position.x = 250;
                textMesh.position.y = 250;
                textMesh.name = "car";
                scene.add(textMesh);
            });
            
            // project 5
            var loader = new THREE.FontLoader();
            let text5 = `PROJECT :
  Batman`;
            loader.load( './Blueberry Regular_Regular.json', function (font) {
                var textGeom = new THREE.TextGeometry(text5, {
                    font: font,
                    size: 50,
                    height: 5,
                    bevelEnabled: true,
                });

                var textMesh = new THREE.Mesh(textGeom, textMaterial[4]);
                textMesh.rotation.y = -3.4;
                textMesh.position.z = 410;
                textMesh.position.x = -15;
                textMesh.name = "batman";
                scene.add(textMesh);
            });

            // project 6
            var loader = new THREE.FontLoader();
            let text6 = `PROJECT :
     Rain`;
            loader.load( './Blueberry Regular_Regular.json', function (font) {
                var textGeom = new THREE.TextGeometry(text6, {
                    font: font,
                    size: 50,
                    height: 5,
                    bevelEnabled: true,
                });

                var textMesh = new THREE.Mesh(textGeom, textMaterial[5]);
                textMesh.rotation.y = -3.9;
                textMesh.position.z = 350;
                textMesh.position.x = -350;
                textMesh.position.y = 250;
                textMesh.name = "rain";
                scene.add(textMesh);
            });

            // project 7
            var loader = new THREE.FontLoader();
            let text7 = `PROJECT :
    Skybox`;
            loader.load( './Blueberry Regular_Regular.json', function (font) {
                var textGeom = new THREE.TextGeometry(text7, {
                    font: font,
                    size: 50,
                    height: 5,
                    bevelEnabled: true,
                });

                var textMesh = new THREE.Mesh(textGeom, textMaterial[6]);
                textMesh.rotation.y = -0.1;
                textMesh.position.z = -500;
                textMesh.position.x = -190;
                textMesh.position.y = 250;
                textMesh.name = "skybox";
                scene.add(textMesh);
            });

            // project 8
            var loader = new THREE.FontLoader();
            let text8 = `PROJECT :
    Space`;
            loader.load( './Blueberry Regular_Regular.json', function (font) {
                var textGeom = new THREE.TextGeometry(text8, {
                    font: font,
                    size: 50,
                    height: 5,
                    bevelEnabled: true,
                });

                var textMesh = new THREE.Mesh(textGeom, textMaterial[7]);
                textMesh.rotation.y = 0.5;
                textMesh.position.z = -400;
                textMesh.position.x = -450;
                textMesh.name = "space";
                scene.add(textMesh);
            });

            // project 9
            var loader = new THREE.FontLoader();
            let text9 = `PROJECT :
Skybox v2`;
            loader.load( './Blueberry Regular_Regular.json', function (font) {
                var textGeom = new THREE.TextGeometry(text9, {
                    font: font,
                    size: 50,
                    height: 5,
                    bevelEnabled: true,
                });

                var textMesh = new THREE.Mesh(textGeom, textMaterial[8]);
                textMesh.rotation.y = 1.5;
                textMesh.position.z = 150;
                textMesh.position.x = -600;
                textMesh.name = "skybox-v2";
                scene.add(textMesh);
            });

            
        
        }

        function onMouseMove(event) {
                event.preventDefault();
                mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
                mouse.y = - (event.clientY / window.innerHeight) * 2 + 1; 
            
                raycaster.setFromCamera(mouse, camera);
                var intersects = raycaster.intersectObjects(scene.children, true);
                
                for(var i = 0; i < intersects.length; i++){
                    if(intersects[i].object && intersects[i].object.name !== "plane"){
                        if(this.click) {
                            let name = intersects[i].object.name;
                            window.location.pathname = "/" + name;
                        }
                    }
                }
        }

        function toogleLight(){
            this.click = !this.click;

            let btn = document.getElementById("light");
            if(this.click){
                this.plight = new THREE.PointLight(0xc4c4c4, 1);
                this.plight.position.set(0,300,500);
                scene.add(this.plight);

                this.plight2 = new THREE.PointLight(0xc4c4c4, 1);
                this.plight2.position.set(500,100,0);
                scene.add(this.plight2);

                this.plight3 = new THREE.PointLight(0xc4c4c4, 1);
                this.plight3.position.set(0,100,-500);
                scene.add(this.plight3);

                this.plight4 = new THREE.PointLight(0xc4c4c4, 1);
                this.plight4.position.set(-500,300,0);
                scene.add(this.plight4);

                scene.remove(this.light);
                btn.innerHTML = "Light Off !"
            } else {
                scene.add(this.light);
                scene.remove(plight);
                scene.remove(plight2);
                scene.remove(plight3);
                scene.remove(plight4);
                btn.innerHTML = "Light On !"
            }
        }

        function render() {
            renderer.render(scene, camera);
        }

        function animate(){
            render();
            requestAnimationFrame(animate);
        }

        init();
    
    </script>
</body>
</html>